# clickhouse 不同的表引擎的优缺点
ClickHouse 支持多种表引擎，不同的引擎适用于不同的使用场景。以下是常见的几种表引擎及其优缺点分析：

### MergeTree 系列引擎
   MergeTree 系列引擎是 ClickHouse 的核心表引擎，适用于大规模数据的高效写入和查询。它们支持分区、主键索引、数据压缩和物化视图。

#### MergeTree
优点：

高效的写入和查询性能，特别适用于批量写入和读操作。
支持主键索引，通过主键排序加速范围查询。
支持分区（partitioning）和分布式部署。
支持数据压缩，优化存储空间。
缺点：

不适合频繁的小规模写入（如 OLTP 场景），会造成大量小文件，影响合并性能。
在极大规模下，合并操作可能会成为性能瓶颈，需要合理配置。
#### ReplacingMergeTree
优点：

可以自动处理重复数据，适用于有数据更新的场景。
通过配置 version 列，保留最新的数据版本，便于更新数据。

缺点：

自动删除旧数据版本的操作在后台异步完成，可能导致删除延迟。
不适合频繁的实时更新，需要等待后台合并完成。 
#### SummingMergeTree
优点：

对数值字段自动求和，适用于汇总场景，如统计总数、金额等。
高效处理按时间维度进行的汇总查询。

缺点：

只适用于数值类型的求和操作，不支持其他聚合函数。
#### AggregatingMergeTree
优点：

支持多种聚合操作，适用于 OLAP 分析场景。
数据在写入时进行预聚合，提升后续查询性能。

缺点：

不适用于实时明细数据查询，因为数据会在写入时聚合。
#### CollapsingMergeTree
优点：

支持增删操作，可以自动合并标记为删除的数据，适用于需要版本控制或有删除需求的场景。
缺点：

删除数据是延迟操作，依赖后台的合并任务完成。
删除逻辑复杂，可能需要专门的调整来保证删除的高效性。
#### VersionedCollapsingMergeTree
优点：

和 CollapsingMergeTree 类似，但支持版本控制，能够通过 version 列标记不同版本的数据并处理冲突。

缺点：

需要正确管理数据版本，操作复杂。
#### Log 系列引擎
   Log 引擎非常简单，适用于无索引、低开销的数据存储。

2.1 Log
优点：

写入操作非常快，适合实时写入大量数据的场景。
没有复杂的索引结构，写入延迟低。
缺点：

读性能差，没有索引，适用于仅写场景。
不支持分区和其他高级功能。
2.2 TinyLog
优点：

非常轻量化，适用于嵌入式系统或资源非常有限的环境。
缺点：

和 Log 引擎类似，没有索引，不适合大数据量和复杂查询。
2.3 StripeLog
优点：

类似于 Log，但支持少量索引，提升查询性能。
缺点：

相较于 MergeTree 系列，索引功能有限，依然不适合复杂查询。
3. Memory
   优点：

数据直接存储在内存中，读写性能极高。
适用于需要快速临时存储的场景，如中间数据存储、缓存。
缺点：

数据不可持久化，ClickHouse 重启后数据丢失。
只适合小数据量场景，受内存限制。
4. Buffer
   优点：

类似于内存缓冲区，将数据先存储在内存中，定期批量写入磁盘。
适合高频写入场景，减少磁盘 I/O 负担。
缺点：

数据最终需要写入底层的 MergeTree 系列表，增加了系统复杂度。
5. Distributed
   优点：

适用于分布式查询，可以跨多个服务器分片查询和写入。
提供分布式数据存储和查询功能，能够水平扩展 ClickHouse 集群。
缺点：

依赖底层表的分布式设计，复杂性较高。
需要合适的负载均衡和分片策略，否则可能导致查询性能瓶颈。
6. Join
   优点：

专门用于高效处理 JOIN 操作的数据存储，适用于关联操作场景。
存储预计算的 join 数据，提升关联查询的性能。
缺点：

只能存储小量数据，通常用于小表的缓存，不适合大表。
7. MaterializedView
   优点：

类似于视图，但会将查询结果持久化到磁盘上，提升查询性能。
能自动维护和更新，适合加速频繁访问的复杂查询。
缺点：

维护视图的代价较高，适用于较为静态的数据集。
写操作的延迟会稍微增加，因为需要维护视图。
### 总结
#### MergeTree 系列引擎适合大规模、批量写入和读操作的场景，尤其适合数据分析场景。
#### ReplacingMergeTree  该引擎和 MergeTree 的不同之处在于它会删除排序键值相同的重复项。
#### Log 和 TinyLog 引擎适合仅写场景，且对读性能要求较低的场景。
#### Memory引擎适合需要极高读写性能、但数据不需要持久化的场景。
#### Buffer引擎可以用于高频写入的数据缓冲，避免直接写入磁盘。
#### Distributed引擎适合跨节点的分布式查询，适用于集群环境中的水平扩展需求。
根据具体的应用场景和需求，选择合适的引擎可以最大化利用 ClickHouse 的性能优势。











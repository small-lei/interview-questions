# MySQL底层的几种实现方式
MySQL 的底层实现主要通过不同的存储引擎来实现。每种存储引擎提供了不同的功能和特性，决定了数据库如何管理数据的存储、检索、事务以及其他操作。常见的 MySQL 存储引擎及其底层实现方式有：

## InnoDB 引擎
   InnoDB 是 MySQL 默认和最常用的存储引擎，提供了支持事务、行级锁、外键约束等高级功能。

### 底层实现方式：
 事务支持：InnoDB 是支持 ACID 特性的事务型存储引擎，具有四个隔离级别（读未提交、读已提交、可重复读和可串行化）。它通过 两阶段提交协议 实现事务的原子性和持久性。
 
 索引：InnoDB 使用聚簇索引，即数据存储与主键索引一起。在聚簇索引中，叶节点保存的是行数据。InnoDB 的辅助索引（非主键索引）叶节点存储的是主键的值，而不是物理地址。
 
 锁机制：支持行级锁，减少了并发操作中的锁争用。行级锁比表级锁更细粒度，性能更优。

 MVCC：InnoDB 使用 多版本并发控制（MVCC），允许高并发下的无锁读操作。MVCC 通过为每个事务生成唯一的版本号来区分不同事务对同一行数据的修改。
 
 数据存储：InnoDB 将数据以 数据页 的方式存储，每个页大小通常为 16KB。每次磁盘 I/O 操作是以页为单位进行的。
### Redo log 和 Undo log：
 Redo log：用于记录事务日志，保证事务的持久性。在系统崩溃后，Redo log 可以帮助恢复已经提交的事务。
 Undo log：保存事务的撤销信息，用于回滚未提交的事务，并支持 MVCC 进行快照读。
### 优点：
强大的事务支持，数据一致性强。
行级锁和 MVCC 支持高并发。
外键支持，适合复杂数据关系的场景。
### 缺点：
相较于其他存储引擎，写入开销更大，特别是涉及事务的情况。
## MyISAM 引擎
   MyISAM 是早期 MySQL 的默认存储引擎，主要用于不需要事务和行级锁的场景，适合查询较多而写操作较少的场景。

### 底层实现方式：
 无事务支持：MyISAM 不支持事务和外键，因此无法保证数据的完整性。

 索引：MyISAM 使用 非聚簇索引。主键索引和数据是分离的，主键索引的叶子节点存储的是数据文件的物理地址。
 
 锁机制：采用 表级锁，当执行更新或插入操作时，整个表会被锁定，无法进行并发写操作。适合读多写少的应用场景。
 
 数据存储：MyISAM 的数据文件以独立的 .MYD 文件形式存储，而索引文件则是 .MYI 文件。每个表都有单独的数据文件和索引文件。
 
 压缩表：MyISAM 支持压缩表，以节省存储空间，尤其适合存储大量的静态数据。
### 优点：
 读操作速度快，适合大量读操作的场景。
 占用的存储空间较小，数据文件相对简单。
### 缺点：
 不支持事务和行级锁，数据安全性和一致性差。
 并发写性能较差，由于使用表级锁，写操作时会阻塞其他操作。
## Memory 引擎
   Memory 引擎（以前称为 HEAP 引擎）将数据存储在内存中，因此读写速度非常快，但一旦 MySQL 服务器关闭或崩溃，数据会丢失。

### 底层实现方式：
 数据存储：所有数据都存储在内存中，因此读写性能极高。表的定义仍然保存在磁盘上，但数据存储在 RAM 中。

 索引：Memory 引擎使用 哈希索引，适合频繁的等值查询。也可以使用 BTree 索引，但哈希索引更为常见。
 
 锁机制：采用 表级锁，由于其主要用于高性能的临时数据存储，因此一般不会遇到大量写操作的场景。

## 优点：
 极高的读写性能，适合临时数据、缓存表等。
 适合频繁的等值查询。
## 缺点：
数据不持久化，服务器重启或崩溃会丢失所有数据。
只支持表级锁。